<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Go Laser Kiwi Go!</title>
    <style>
        body {
            padding: 0;
            margin: 0;
            background-color: #333;
        }
        @-webkit-keyframes AnimationName {
            0%{background-position:0% 50%}
            50%{background-position:100% 50%}
            100%{background-position:0% 50%}
        }
        @-moz-keyframes AnimationName {
            0%{background-position:0% 50%}
            50%{background-position:100% 50%}
            100%{background-position:0% 50%}
        }
        @keyframes AnimationName {
            0%{background-position:0% 50%}
            50%{background-position:100% 50%}
            100%{background-position:0% 50%}
        }
        .intro a {
            background: linear-gradient(270deg, #2672f1, #f23207);
            background-size: 400% 400%;
            -webkit-animation: AnimationName 22s ease infinite;
            -moz-animation: AnimationName 22s ease infinite;
            animation: AnimationName 22s ease infinite;
            display: block;
            position: absolute;
            margin: auto;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 250px;
            height: 100px;
            text-align: center;
            line-height: 100px;
            text-transform: uppercase;
            font-size: 39px;
            font-family: Helvetica Neue,Helvetica,Arial,sans-serif;
            font-weight: 800;
            text-decoration: none;
            border-radius: 15px;
            color: white;
            text-shadow: 2px 2px #333;
            transition: all 0.5s ease;
        }
        .intro a:hover {
            background-color: red;
        }
        .explosion {
            z-index: 80;
            position: absolute;
            right: 0;
            top:0;
        }
        .kiwi {
            position: absolute;
            top: 0;
            left: 0;
            display: block;
            z-index: 100;
        }
        .kiwi svg {
            width: 100%;
            height: 100%;
            z-index: 90;
            position: relative;
            display: block;
        }
        .flag {
            z-index: 70;
            position: absolute;
            right: 0;
            top:0;
        }
        .flag img {
            width: auto;
            height: 50%;
            margin-top: 25%;
        }
        .laser {
            width: 120px;
            height: 120px;
            position: absolute;
            z-index: 80;
            left: 90px;
            display: block;
        }
        .laser .bean {
            width: 120px;
            height: 10px;
            position: relative;
            border-radius: 50%;
            background-color: #33FF33;
        }
    </style>
    <script src="js/jquery-2.1.4.min.js"></script>
    <script type="text/javascript">

        var flagCount = 0;
        var flag = 0;
        var flags = [];
        var flag0 = "<img src='https://www.govt.nz/assets/flags-designs/2170-kyle-lockwood-silver-fern-nz-flag-final-cr-3.png'/>"
        var flag1 = "<img src='https://www.govt.nz/assets/flags-designs/4.-Alofi-Kanter-Silver-Fern-Black-and-White.jpg'/>"
        var flag2 = "<img src='https://www.govt.nz/assets/flags-designs/2172-kyle-lockwood-silver-fern-nz-flag-final-cr-4.png'/>"
        var flag3 = "<img src='https://www.govt.nz/assets/flags-designs/Koru-web.jpg'/>"
        var explosion = "<div class='explosion'><img src='http://rs517.pbsrc.com/albums/u333/PhotoPun/explosion.gif~c200'/></div>"
        var contact = 0;
        var count = 0;
        var flagNumber = 0;
        var previousFlagPosition = 0;
        var thisFlagPosition = Math.floor(Math.random()*5);
        var heightTotal = $(window).height();
        var widthTotal = $( window ).width();
        var kiwi = null;

        function laserBeam() {
            if($('.laser').length<1) {
                $('body').append("<div id='laser' class='laser'><div class='bean'></div></div>");
                var laser = $('.laser');
                laser.css('height',(heightTotal/6));
                laser.css('top',(kiwi.offset().top) + (kiwi.height()/3));
                laser.animate({
                    left: widthTotal
                },700, "linear");
                setTimeout(function(){ laser.remove() }, 700);
            }
        };

        function createFlag() {
            flagPosition();
            flagCount += 1;
            var flag = $("<div>")
               .addClass("flag")
               .addClass('n' + flagCount)
               .append(eval('flag' + Math.floor(Math.random()*4)))
               .css({ top: ((heightTotal/6)*thisFlagPosition+5), height: (heightTotal/6) });
            $('body').append(flag);
        };

        function collision(div1, div2) {
            if (!$(div1).length) {
                return false;
            }
            var x1 = $(div1).offset().left;
            var y1 = $(div1).offset().top;
            var h1 = $(div1).outerHeight(true);
            var w1 = $(div1).outerWidth(true);
            var b1 = y1 + h1;
            var r1 = x1 + w1;
            var x2 = $(div2).offset().left;
            var y2 = $(div2).offset().top;
            var h2 = $(div2).outerHeight(true);
            var w2 = $(div2).outerWidth(true);
            var b2 = y2 + h2;
            var r2 = x2 + w2;
            if (b1 < y2 || y1 > b2 || r1 < x2 || x1 > r2) return false;
            return true;
        };

        function flagPosition() {
            while (previousFlagPosition === thisFlagPosition) {
                thisFlagPosition = Math.floor(Math.random()*5);
            }
            previousFlagPosition = thisFlagPosition;
        };

        function startGame() {
            $(".intro").remove();
            $("body").append("<div class='kiwi'><svg version='1.1' id='kiwi' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' viewBox='0 0 278 205' enable-background='new 0 0 278 205' xml:space='preserve'><path fill='#a76a19' d='M32.9,126.3c5.9,8,11.8,16,17.6,24.1c3.9,5.4,7.8,10.8,11.6,16.3c4.3,6.2,6.1,8.7,5.3,16c-0.5,3.9-2.5,3.5,1.4,5.4c4.6,2.2,10.2,0.5,15,3.7c0.9,0.6,3.6,3.6,4.2,3.7c4.2,1,2.5-1.2,4.6-2.4c2.3-1.4,1.1-2.4,4.4-2.7c2.4-0.2,5.6,2.3,8.1,2.5c9,0.8,4.5-3.9-0.5-6.1c-5.2-2.3-11.3-3.4-16.7-5.1c-5.2-1.6-10-2.1-11-7.8c-0.9-5.2,0.8-16.6,3.5-21.1c5.6-9.5,16.2-2.4,21.5,3.6c3.3,3.7,6,8.1,7.6,12.8c2.3,7.2,1.2,8.1,8.7,11.8c2.2,1.1,6.6,4.1,9.1,4.3c4.3,0.3,1.2,0.3,4.6-1.5c1.2-0.6,1-2.5,2.7-3.3c2.2-1,4.3,1.2,6.5,0.4c5.9-2.2-3.3-4-6.4-5.2c-5.8-2.1-11.3-3.5-14.9-8.9c-2.4-3.5-9.8-18.4-6.9-21.6c1.9-2.2,10.5-1.2,13-1.3c7.3-0.4,14.6-1,21.8-2.2c13.8-2.3,28.8-5.1,41.6-11.3c5.2-2.5,10.2-5.8,14.3-9.9c3.8-3.7,6.4-8.9,10.7-12c11.4-8.1,22.6,1.4,29.5,10c9.6,11.9,18,24.2,26.1,37.1c2.2-4.7-13.9-29.1-17.5-34.5c-3.6-5.4-20.8-23.7-22.9-28.2c-2.3-4.8-0.8-10.7-3.4-15.9c-1.9-3.7-5.2-7.2-8.4-9.8c-10.9-8.8-20.5-4.1-32.8-2.3c-12.8,1.9-22.6-7.7-33.2-13.8c-12.2-7-24.2-14.7-37.4-19.7c-13.5-5-28.4-8.5-42.8-5.6c-15.1,3-26.9,12.2-39.4,20.5C-7.2,79.5,14.8,101.9,32.9,126.3z'/><circle fill='#FFFFFF' cx='211' cy='78.4' r='3.3'/></svg></div>");

            kiwi = $('.kiwi');

            $(document).keydown(function(e) {
                switch (e.which) {
                    case 38:
                        if (!(kiwi.offset().top <= 0)) {
                            kiwi.css('top', kiwi.offset().top - (heightTotal/6));
                            count -=1;
                        }else {
                            break;
                        }
                        break;
                    case 40:
                        if (count < 4) {
                            kiwi.css('top', kiwi.offset().top + (heightTotal/6));
                            count +=1;
                        }else {
                            break;
                        };
                            break;
                    case 32:
                        laserBeam();
                        break;
                }
            });

            kiwi.css('height',(heightTotal/6));

            window.setInterval(function() {
                flags = $('.flag').toArray();
                $(flags).each(function(){
                    flagNumber = $(this).attr('class');
                    if(collision($('#laser .bean'), $(this))) {
                        $(this).after(explosion);
                        $('#laser').remove();
                        $('.explosion').css('top',$(this).offset().top);
                        $('.explosion').css('left',$(this).offset().left);
                        $(this).remove();
                        if ($('.explosion').length) {
                            setTimeout(function(){ $('.explosion').remove() }, 800);
                        }
                    }
                    $(this).animate({
                        right: widthTotal
                    },3500, "linear");
                });
            }, 10);

            setInterval(function(){ createFlag() }, 1500);

        }
    </script>
</head>

<body>

    <div class="intro">
        <a href="javascript:void(0)" onclick="startGame();">Play</a>
    </div>

    <div class="loading-assets" style="display: none;">
        <img src='https://www.govt.nz/assets/flags-designs/2170-kyle-lockwood-silver-fern-nz-flag-final-cr-3.png'/>
        <img src='https://www.govt.nz/assets/flags-designs/4.-Alofi-Kanter-Silver-Fern-Black-and-White.jpg'/>
        <img src='https://www.govt.nz/assets/flags-designs/2172-kyle-lockwood-silver-fern-nz-flag-final-cr-4.png'/>
        <img src='https://www.govt.nz/assets/flags-designs/Koru-web.jpg'/>
        <img src="http://rs517.pbsrc.com/albums/u333/PhotoPun/explosion.gif~c200" />
    </div>

</body>
</html>